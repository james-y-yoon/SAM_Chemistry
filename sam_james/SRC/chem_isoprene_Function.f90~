! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
! 
! The ODE Function of Chemical Model File
! 
! Generated by KPP-2.2.3 symbolic chemistry Kinetics PreProcessor
!       (http://www.cs.vt.edu/~asandu/Software/KPP)
! KPP is distributed under GPL, the general public licence
!       (http://www.gnu.org/copyleft/gpl.html)
! (C) 1995-1997, V. Damian & A. Sandu, CGRER, Univ. Iowa
! (C) 1997-2005, A. Sandu, Michigan Tech, Virginia Tech
!     With important contributions from:
!        M. Damian, Villanova University, USA
!        R. Sander, Max-Planck Institute for Chemistry, Mainz, Germany
! 
! File                 : chem_isoprene_Function.f90
! Time                 : Tue Dec 14 21:07:24 2021
! Working directory    : /home/disk/eos6/mwyant/isoprene/kpp-2.2.3/smalltest
! Equation file        : iso_test.kpp
! Output root filename : iso_test
! 
! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



MODULE chem_isoprene_Function


  USE chem_isoprene_Parameters
  IMPLICIT NONE



CONTAINS


! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
! 
! Fun - time derivatives of variables - Agregate form
!   Arguments :
!      V         - Concentrations of variable species (local)
!      F         - Concentrations of fixed species (local)
!      RCT       - Rate constants (local)
!      Vdot      - Time derivative of variable species concentrations
! 
! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SUBROUTINE Fun (nzm, V, F, RCT, Vdot )


  integer, intent(in) :: nzm
! V - Concentrations of variable species (local)
  REAL*8 :: V(nzm, NVAR)
! F - Concentrations of fixed species (local)
  REAL*8 :: F(nzm, NFIX)
! RCT - Rate constants (local)
  REAL*8 :: RCT(nzm, NREACT)
! Vdot - Time derivative of variable species concentrations
  REAL*8, intent(inout) :: Vdot(nzm,NVAR)
! A - Rate for each equation
  REAL*8 :: A(nzm,NREACT)

! Computation of equation rates
  A(:,1) = RCT(:,1)*F(:,1)*F(:,6)
  A(:,2) = RCT(:,2)*V(:,1)*F(:,5)
  A(:,3) = RCT(:,3)*V(:,1)*F(:,2)
  A(:,4) = 1e-12*V(:,1)*F(:,4)
  A(:,5) = 1e-12*V(:,1)*V(:,1)
  A(:,6) = 1.54e-10*V(:,2)*F(:,1)
  A(:,7) = RCT(:,7)*V(:,5)
  A(:,8) = RCT(:,8)*V(:,5)*F(:,5)
  A(:,9) = RCT(:,9)*V(:,5)*F(:,2)
  A(:,10) = 1e-12*V(:,5)*F(:,4)
  A(:,11) = 2.17e-11*V(:,3)*F(:,1)
  A(:,12) = RCT(:,12)*V(:,11)*F(:,5)
  A(:,13) = RCT(:,13)*V(:,11)*F(:,2)
  A(:,14) = 1e-12*V(:,11)*F(:,4)
  A(:,15) = 8.4e-12*V(:,4)*F(:,1)
  A(:,16) = 8.4e-12*V(:,6)*F(:,1)
  A(:,17) = RCT(:,17)*V(:,10)*F(:,1)
  A(:,18) = RCT(:,18)*V(:,13)*F(:,3)
  A(:,19) = RCT(:,19)*V(:,15)
  A(:,20) = RCT(:,20)*V(:,13)*F(:,2)
  A(:,21) = 1.63e-12*V(:,12)*F(:,1)
  A(:,22) = RCT(:,22)*V(:,7)*F(:,1)
  A(:,23) = RCT(:,23)*V(:,14)*F(:,1)
  A(:,24) = RCT(:,24)*V(:,8)*F(:,1)
  A(:,25) = RCT(:,25)*V(:,9)*F(:,1)

! Aggregate function
  Vdot(:,1) = A(:,1)-A(:,2)-A(:,3)-A(:,4)-2*A(:,5)
  Vdot(:,2) = A(:,2)-A(:,6)
  Vdot(:,3) = 0.105*A(:,3)-A(:,11)
  Vdot(:,4) = 0.7*A(:,6)-A(:,15)
  Vdot(:,5) = 0.3*A(:,6)-A(:,7)-A(:,8)-A(:,9)-A(:,10)
  Vdot(:,6) = A(:,7)-A(:,16)
  Vdot(:,7) = A(:,8)-A(:,22)
  Vdot(:,8) = 0.13*A(:,9)-A(:,24)
  Vdot(:,9) = 0.3*A(:,10)-A(:,25)
  Vdot(:,10) = 0.896*A(:,3)+0.7*A(:,4)+2*A(:,5)+0.87*A(:,9)+0.7*A(:,10)+A(:,15)+A(:,16)-A(:,17)+A(:,22)+A(:,25)
  Vdot(:,11) = A(:,11)-A(:,12)-A(:,13)-A(:,14)
  Vdot(:,12) = 0.16*A(:,13)-A(:,21)
  Vdot(:,13) = A(:,17)-A(:,18)-A(:,20)
  Vdot(:,14) = 0.84*A(:,13)+0.7*A(:,14)+0.07*A(:,20)+A(:,21)-A(:,23)+A(:,24)
  Vdot(:,15) = A(:,18)-A(:,19)
  Vdot(:,16) = 0.896*A(:,3)+0.87*A(:,9)+0.7*A(:,10)+0.84*A(:,13)+0.7*A(:,14)+A(:,15)+A(:,16)+1.86*A(:,20)+A(:,21)+A(:,22)+2*A(:,23)+A(:,24)+A(:,25)
  Vdot(:,17) = 2*A(:,5)+1.86*A(:,20)+2*A(:,23)
  Vdot(:,18) = 0.3*A(:,4)
  Vdot(:,19) = A(:,12)
  Vdot(:,20) = 0.3*A(:,14)
      
END SUBROUTINE Fun

! End of Fun function
! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



END MODULE chem_isoprene_Function

